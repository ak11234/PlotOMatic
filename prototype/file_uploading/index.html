<html>
  <head>

  </head>
  <body>
    <div id="target">Drag File Here!</div>
    <img src = "" id = "image_display">
    <button id="post-button" onclick = "post_image()">post</button>
    <script>
      const target = document.getElementById('target');

      target.addEventListener('drop', (e) => {
        e.stopPropagation();
        e.preventDefault();

        showImage(e.dataTransfer.files);
      });
      //NOTE: YOU CAN UPLOAD MULTIPLE IMAGES AT ONCE WITH FILE LIST (USEFUL)
      function showImage(fileList) {
        file = fileList.item(0)
        image_file = file
        var url = URL.createObjectURL(file);
        document.getElementById("image_display").src = url;
        post_image()
      }
      image_file = null
      target.addEventListener('dragover', (e) => {
        e.stopPropagation();
        e.preventDefault();

        e.dataTransfer.dropEffect = 'copy';
      });

      function post_image(){
        url = "https://canadacentral.api.cognitive.microsoft.com/vision/v1.0/tag"
        data = image_file
        xhr = new XMLHttpRequest();
        xhr.open('POST', url);
        xhr.setRequestHeader('Ocp-Apim-Subscription-Key', "a18ed5f12ff343a99b8c4465fdcdd004");
        xhr.setRequestHeader('Content-Type', "application/octet-stream");
        xhr.send(data)
        xhr.onreadystatechange = function () {
          if(xhr.readyState === 4 && xhr.status === 200) {
            console.log(xhr.responseText);
          }
        }
      }
/*
      var newName = 'John Smith',

xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
xhr.onload = function() {
    if (xhr.status === 200 && xhr.responseText !== newName) {
        alert('Something went wrong.  Name is now ' + xhr.responseText);
    }
    else if (xhr.status !== 200) {
        alert('Request failed.  Returned status of ' + xhr.status);
    }
};
xhr.send(encodeURI('name=' + newName));


      $("button").click(function(){
        url = "http://canadacentral.api.cognitive.microsoft.com/vision/v1.0/tag"
        headers = {
          'content-type': "application/json; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW",
          'Ocp-Apim-Subscription-Key': "a18ed5f12ff343a99b8c4465fdcdd004",
          'Content-Type': "application/octet-stream",
          'Cache-Control': "no-cache"
        }
        data = image_file
        data = {
          headers, body
        }
        $.post(url, data, function(data){
            console.log(data)
        });
      });*/
    </script>
  </body>
</html>
